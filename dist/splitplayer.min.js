/* SplitPlayer 1.0.0 - http://www.splitplay.tv */
"use strict";var SplitPlayer=function(a){this.videos=[],this.plugins=[],this.readyCount=0,this.playerState=1,this.settings=$.extend({type:"youtube",videos:[],dropArea:null,maxVideos:2,onReady:function(){},onLoading:function(){},onPlay:function(){},onPause:function(){}},a),this.render();var b=!0,c=!1,d=void 0;try{for(var e,f=this.settings.videos[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;this.addVideo(g)}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return this.playerState=2,this};SplitPlayer.prototype={extend:function(a){this.plugins.push(new a(this))},addVideo:function(a){return this.videos.length>=this.settings.maxVideos?!1:void this.videos.push(new sp.component.player.video(this,{video:a}))},removeVideo:function(a){_.findWhere(this.videos,a).remove(),this.videos=_.without(this.videos,_.findWhere(this.videos,a)),this.readyCount=0},onReady:function(){if(this.readyCount++,this.readyCount!==this.videos.length)return!1;this.playerState=3,this.settings.onReady(this);var a=!0,b=!1,c=void 0;try{for(var d,e=this.plugins[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.onReady()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}},play:function(){if(this.readyCount!==this.videos.length)return!1;this.settings.onPlay(this);var a=!0,b=!1,c=void 0;try{for(var d,e=this.videos[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.play()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}var h=!0,i=!1,j=void 0;try{for(var k,l=this.plugins[Symbol.iterator]();!(h=(k=l.next()).done);h=!0){var m=k.value;m.onPlay()}}catch(g){i=!0,j=g}finally{try{!h&&l["return"]&&l["return"]()}finally{if(i)throw j}}},pause:function(){if(this.readyCount!==this.videos.length)return!1;this.settings.onPause(this);var a=!0,b=!1,c=void 0;try{for(var d,e=this.videos[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.pause()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}var h=!0,i=!1,j=void 0;try{for(var k,l=this.plugins[Symbol.iterator]();!(h=(k=l.next()).done);h=!0){var m=k.value;m.onPause()}}catch(g){i=!0,j=g}finally{try{!h&&l["return"]&&l["return"]()}finally{if(i)throw j}}},timeTo:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this.videos[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g.timeTo(a)}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}},render:function(){sp.template({name:"player/player",data:{},insertPoint:"append",target:$(this.settings.dropArea)})}};var SplitPlayerTimeline=function(a,b){return this.player=a,this.playedTime=0,this.cycler=0,this.paused=!0,this.timeLine=null,this.settings=$.extend({element:null,currentTimeElement:null,durationElement:null,startTime:0,duration:1e4,previewLine:$(".preview-line"),onChange:function(){}},b),this.playedTime=this.settings.startTime,this.setEvents(),$(this.settings.durationElement).html(this.formatTime(this.settings.duration)),$(this.settings.currentTimeElement).html("0:00"),this};sp.component.player.plugin.timeline.prototype={onPlay:function(){this.paused=!1,this.run()},onPause:function(){this.paused=!0,clearTimeout(this.cycler)},onStop:function(){this.playedTime=0,this.update()},setEvents:function(){var a=this;this.timeLine=$(this.settings.element),this.timeLine.attr("max",this.settings.duration).rangeslider({polyfill:!1}),$(".rangeslider").on("mousedown",function(){a.player.timeTo(a.playedTime)}).on("mousemove",function(b){var c=b.pageX-$(this).offset().left,d=100*c/$(this).width(),e=Math.round(d),f=a.formatTime(a.settings.duration/100*e);a.settings.previewLine.width(d+"%").find("time").html(f)}),$(document).on("input",'input[type="range"]',function(){var b=$(this).val();a.playedTime=b,a.settings.onChange(b)})},run:function(){return this.playedTime>=this.settings.duration||this.paused?this.pause():(this.playedTime++,this.update(),clearTimeout(this.cycler),void(this.cycler=setTimeout(this.run.bind(this),1e3)))},update:function(){this.timeLine.val(this.playedTime).change(),$(this.settings.currentTimeElement).html(this.formatTime(this.playedTime))},formatTime:function(a){var b=Math.floor(a/60),c=Math.round(a-60*b);return 10>c&&(c="0"+c),b+":"+c}};var SplitPlayerVideo=function(a,b){return this.player=a,this.videoPlayer=null,this.settings=$.extend({video:null,type:"youtube"},b),this.render(),this};SplitPlayerVideo.prototype={create:function(){this.videoPlayer=new YT.Player("player"+this.settings.video.videoId,{width:"100%",height:"100%",videoId:this.settings.video.videoId,playerVars:{controls:this.settings.active?1:0},events:{onReady:this.onReady.bind(this),onStateChange:this.onStateChange.bind(this)}})},onReady:function(){this.timeTo(0),this.pause(),this.player.onReady()},onStateChange:function(a){switch(a.data){case YT.PlayerState.PLAYING:this.player.play();break;case YT.PlayerState.PAUSED:this.player.pause()}},remove:function(){this.player.removeVideo(this.settings.video),this.videoPlayer.destroy()},timeTo:function(a){this.videoPlayer.seekTo(a+this.settings.video.startSeconds)},play:function(){this.videoPlayer.playVideo()},pause:function(){this.videoPlayer.pauseVideo()},getDuration:function(){this.videoPlayer.getDuration()},render:function(){}};